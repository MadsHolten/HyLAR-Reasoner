<!DOCTYPE html>
<html lang="en">
<head>
    <% include ../partials/head.ejs %>
</head>
<body>
<header>
    <% include ../partials/menu.ejs %>
</header>
<section class="hero is-dark">
    <div class="hero-body">
        <p class="title">
            SPARQL Endpoint
        </p>
    </div>
</section>
<section class="section">
    <div class="container">
        <textarea id="query" name="query"><%- sparqlQuery %></textarea>
        <div class="columns">
            <div class="column">
                <input onclick="sparql(this, '<%- contextPath %>')" style="margin-top: 10px" class="button is-info" type="submit" value="Submit query">
            </div>
            <div class="column">
                <div class="powered-by">
                    Powered by
                    <a class="rdfstore" href="https://www.npmjs.com/package/rdfstore"><img width="14px" height="14px" src="<%- contextPath %>/img/rdf.png"> rdfstore.js</a> and
                    <a class="yasqe" href="https://yasqe.yasgui.org/"><img width="14px" height="14px" src="<%- contextPath %>/img/yasqe.png"> YASQE</a>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="sparql-results-section" style="display:none;" class="section">
    <div class="container">
        <h1 class="subtitle">Results</h1>
        <table id="sparql-results-table" class="table is-bordered table-responsive is-fullwidth"></table>
    </div>
</section>

<div class="container">
    <div id="sparql-graph-result" class="container graph-result" style="display:none;">
    </div>
</div>

<section class="section">
    <div class="container">
        <h1 class="subtitle">Query history</h1>
        <table class="table is-warning is-bordered is-striped table-responsive is-fullwidth">
            <tr>
                <th>SPARQL query</th>
                <th>Status</th>
            </tr>
            <% for (var i = (history.length-1); i > -1; i--) { %>
            <tr class="queryhistory" onclick="putSparql('q<%- i %>')">
                <td id="q<%- i %>"><%= history[i].query %></td>
                <td class="sparqlstatus">
                    <% if(history[i].noError) { %>
                    <span class="noerror glyphicon glyphicon-ok"> Passed</span>
                    <% } else { %>
                    <span class="error glyphicon glyphicon-remove-circle"> Errored</span>
                    <% } %>
                </td>
            </tr>
            <% } %>
        </table>
    </div>
</section>

<script>
    let sparqlQuery = YASQE.fromTextArea(document.getElementById('query'))
</script>

</body>
</html>